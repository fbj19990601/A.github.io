<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
</head>
<body>
<script LANGUAGE="JavaScript">

if (external.menuArguments) {
	var parentwin = external.menuArguments;
	if (parentwin.document.selection) {
		var sel = parentwin.document.selection.createRange().text;
	}
	if (!sel) {
		var sel = '';
	}
	sel=substr(sel,1,240);
	
	var url = parentwin.location.href;
	var title = parentwin.document.title;
	
	
	if (parentwin.event.srcElement.tagName == "A") {
		url = parentwin.event.srcElement.getAttribute("HREF");
		title = parentwin.event.srcElement.innerText;
	}
	title=substr(title,1,76);
	url=substr(url,1,255);
	try {
		  
		//var w = window.open('http://cang.baidu.com/do/add?it='+java.net.URLDecoder.decode(encodeURIComponent(title))+'&iu='+encodeURIComponent(url)+'&dc='+encodeURIComponent(sel)+"&fr=ier#nw=1",'_blank','scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes');
		var w = window.open('/addfav.jsp?it='+ title+'&iu='+url+'&dc='+encodeURIComponent(sel)+"&fr=ier#nw=1",'_blank','scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable=yes');
	} catch (e) {}
	 
	 
} else {
	history.go(-1);
}
function substr(str,num1,num2)
{
        var bytes=0; 
        var retStr="";
        for(var i=0;i<str.length;i++){  
                if(str.charCodeAt(i)>127){
                         bytes=bytes+2;
                }
                else{
                        bytes++;
                }
                if (bytes<(num2+1) && bytes>(num1-1)){
                        retStr=retStr+str.charAt(i);
                }
        }
        return retStr;
}
</script>
</body>
</html>
